name: üèà NFL Live (Daily Planner)

on:
  # Run frequently on typical NFL days to refresh live lines, update finals, etc.
  schedule:
    # Thu‚ÄìMon: every 10 minutes from ~11:00 AM ET through ~2:00 AM ET
    - cron: "*/10 16-6 * * 4-1"
  workflow_dispatch:

jobs:
  watchers:
    name: live
    runs-on: ubuntu-latest
    timeout-minutes: 15

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: "20"

      - name: Install dependencies
        run: |
          # axios is required by orchestrator.mjs
          npm install googleapis axios

      # Pull & refresh today's slate (pregame + live), and sweep finals.
      # We purposely run this frequently; orchestrator is idempotent and cheap.
      - name: Update live board (today) + finals sweep
        env:
          GOOGLE_SHEET_ID: ${{ secrets.GOOGLE_SHEET_ID }}
          GOOGLE_SERVICE_ACCOUNT: ${{ secrets.GOOGLE_SERVICE_ACCOUNT }}
          LEAGUE: nfl
          TAB_NAME: NFL
          PREFILL_MODE: today
        run: node orchestrator.mjs
